#Java生成唯一ID算法.md
---

## java 循环导致UUID重复问题
\-

是这样的，为了避免重复，将主键设置为UUID，然后没想到居然报错了，内容是主键重复，一脸蒙圈，不是说3000年不会重复吗。
之前生成的时候也没出现过这种情况。

但是这次我是批量插入的，然后自己仔细的看了一些文档后总结了下可能出现的原因，

因为我是在循环中生成UUID，可能是由于程序循环的时候太快了，导致几乎在同一时间生成UUID，所以才会导致这种重复的情况，

那么怎么解决呢？
解决方案：
将生成UUID的代码加一个锁，这样每次只会进来一条，保证生成一条以后继续生成第二条，这样就可以避免这种情况。

String s="";
synchronized (s) {
    s = java.util.UUID.randomUUID().toString();
 }